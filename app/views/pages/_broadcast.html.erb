<%= content_tag("li", :class => :two) do %>
	<%= content_tag("h3", broadcast.title.html_safe) %>
	<%= content_tag("span", :class => :channel) do %>
		<%= broadcast.channel.name.html_safe %>
		<%= content_tag("span", broadcast.start.strftime('%H:%M'), :class => :time) %>
	<% end %>
	
	<%= content_tag("span", broadcast.synopsis.html_safe, :class => :description)%>
	<%= content_tag("span", hours_and_minutes(broadcast.duration), :class => "prog-length") %>

	<% if signed_in? %>
                <%= render :partial => 'watchers', :locals => { :user => current_user, :broadcast => broadcast } %>
	<% end %>
		
	<% if signed_in? %>
		<% intention = broadcast.intentions.find_by_user_id(current_user.id) %>

		<% unless intention %>

			<%= link_to intentions_path(:broadcast_id => broadcast.id), :class => "watch-toggle", :method => :create do %><%= content_tag("span", broadcast.intentions.count.to_i.to_s, :class => :count, :title => "Number of people watching this") %>Watch<% end %>
			
		<% else %>
			<%= link_to intention_path(intention), :method => :delete, :class => "watch-toggle watching" do %><%= content_tag("span", broadcast.intentions.count.to_i.to_s, :class => :count, :title => "Number of people watching this") %>Unwatch<% end %>
		<% end %>

	<% else %>

		<%= link_to intentions_path(:broadcast_id => broadcast.id), :method => "create", :class => "watch-toggle" do %><%= content_tag("span", broadcast.intentions.count.to_i.to_s, :class => :count, :title => "Number of people watching this") %>Watch<% end %>
	
	<% end %>
		

<% end %>
